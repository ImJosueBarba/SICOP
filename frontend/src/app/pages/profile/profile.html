<div class="profile-container">
  <p-card>
    <ng-template pTemplate="header">
      <div class="profile-header">
        <button pButton type="button" icon="pi pi-arrow-left" class="p-button-text" (click)="goBack()"></button>
        <h2>Mi Perfil</h2>
      </div>
    </ng-template>

    <div class="profile-content">
      <!-- Photo Section -->
      <div class="photo-section">
        <div class="photo-wrapper">
          <div class="photo-container">
            @if (profileImage) {
              <img 
                [src]="profileImage" 
                alt="Foto de perfil"
                class="profile-photo" />
            } @else {
              <div class="photo-placeholder">
                <i class="pi pi-user"></i>
              </div>
            }
          </div>
          
          <div class="photo-actions">
            <p-fileUpload 
              mode="basic" 
              name="photo"
              accept="image/*"
              [maxFileSize]="5000000"
              chooseLabel="Cambiar Foto"
              chooseIcon="pi pi-camera"
              [auto]="false"
              (onSelect)="onFileSelect($event)"
              class="upload-button">
            </p-fileUpload>
            
            @if (profileImage) {
              <button 
                pButton 
                type="button" 
                label="Eliminar"
                icon="pi pi-trash"
                class="p-button-danger p-button-outlined"
                (click)="onRemoveImage()">
              </button>
            }
          </div>
          
          <p class="photo-hint">Tamaño máximo: 5MB. Formatos: JPG, PNG, GIF</p>
        </div>
      </div>

      <!-- Form Section -->
      <div class="form-section">
        <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
          <div class="form-grid">
            <!-- Nombre -->
            <div class="form-field">
              <p-floatlabel>
                <input 
                  pInputText 
                  id="nombre" 
                  formControlName="nombre"
                  class="w-full" />
                <label for="nombre">Nombre Completo</label>
              </p-floatlabel>
            </div>

            <!-- Email -->
            <div class="form-field">
              <p-floatlabel>
                <input 
                  pInputText 
                  id="email" 
                  type="email"
                  formControlName="email"
                  class="w-full" />
                <label for="email">Correo Electrónico</label>
              </p-floatlabel>
            </div>

            <!-- Usuario (read-only) -->
            <div class="form-field">
              <p-floatlabel>
                <input 
                  pInputText 
                  id="usuario" 
                  formControlName="usuario"
                  class="w-full" />
                <label for="usuario">Usuario</label>
              </p-floatlabel>
            </div>

            <!-- Rol (read-only) -->
            <div class="form-field">
              <p-floatlabel>
                <input 
                  pInputText 
                  id="rol" 
                  formControlName="rol"
                  class="w-full" />
                <label for="rol">Rol</label>
              </p-floatlabel>
            </div>
          </div>

          <!-- Messages -->
          @if (successMessage) {
            <p-message 
              severity="success" 
              [text]="successMessage"
              styleClass="w-full mt-3">
            </p-message>
          }

          @if (errorMessage) {
            <p-message 
              severity="error" 
              [text]="errorMessage"
              styleClass="w-full mt-3">
            </p-message>
          }

          <!-- Actions -->
          <div class="form-actions">
            <button 
              pButton 
              type="button" 
              label="Cancelar" 
              icon="pi pi-times"
              class="p-button-text"
              (click)="goBack()">
            </button>
            <button 
              pButton 
              type="submit" 
              label="Guardar Cambios" 
              icon="pi pi-check"
              [loading]="loading"
              [disabled]="profileForm.invalid">
            </button>
          </div>
        </form>
      </div>
    </div>
  </p-card>
</div>
